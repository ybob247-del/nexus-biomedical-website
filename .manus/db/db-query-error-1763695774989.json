{
  "query": "-- RxGuard™ Database Schema\n-- Drug Interaction Checker Platform\n\n-- Table: medications\nCREATE TABLE IF NOT EXISTS medications (\n    id SERIAL PRIMARY KEY,\n    rxcui VARCHAR(50) UNIQUE NOT NULL,\n    drug_name VARCHAR(255) NOT NULL,\n    generic_name VARCHAR(255),\n    brand_names TEXT[],\n    active_ingredients TEXT[],\n    dosage_form VARCHAR(100),\n    strength VARCHAR(100),\n    manufacturer VARCHAR(255),\n    ndc_codes TEXT[],\n    drug_class VARCHAR(255),\n    fda_application_number VARCHAR(50),\n    approval_date DATE,\n    warnings TEXT,\n    contraindications TEXT,\n    adverse_reactions TEXT,\n    drug_interactions TEXT,\n    pregnancy_category VARCHAR(10),\n    controlled_substance_class VARCHAR(10),\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Table: drug_interactions\nCREATE TABLE IF NOT EXISTS drug_interactions (\n    id SERIAL PRIMARY KEY,\n    drug_a_rxcui VARCHAR(50) NOT NULL,\n    drug_b_rxcui VARCHAR(50) NOT NULL,\n    interaction_type VARCHAR(50) NOT NULL,\n    severity_score INTEGER CHECK (severity_score BETWEEN 1 AND 10),\n    description TEXT NOT NULL,\n    mechanism TEXT,\n    clinical_effects TEXT,\n    management_recommendations TEXT,\n    evidence_level VARCHAR(50),\n    source VARCHAR(100),\n    source_url TEXT,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    CONSTRAINT unique_interaction UNIQUE (drug_a_rxcui, drug_b_rxcui)\n);\n\n-- Table: user_medication_lists\nCREATE TABLE IF NOT EXISTS user_medication_lists (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER NOT NULL,\n    list_name VARCHAR(255) DEFAULT 'My Medications',\n    is_active BOOLEAN DEFAULT true,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Table: user_medications\nCREATE TABLE IF NOT EXISTS user_medications (\n    id SERIAL PRIMARY KEY,\n    list_id INTEGER NOT NULL REFERENCES user_medication_lists(id) ON DELETE CASCADE,\n    medication_id INTEGER NOT NULL REFERENCES medications(id),\n    dosage VARCHAR(100),\n    frequency VARCHAR(100),\n    route VARCHAR(50),\n    start_date DATE,\n    end_date DATE,\n    prescriber_name VARCHAR(255),\n    notes TEXT,\n    is_active BOOLEAN DEFAULT true,\n    added_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Table: interaction_checks\nCREATE TABLE IF NOT EXISTS interaction_checks (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER NOT NULL,\n    list_id INTEGER REFERENCES user_medication_lists(id),\n    medications_checked TEXT[],\n    interactions_found INTEGER DEFAULT 0,\n    major_interactions INTEGER DEFAULT 0,\n    moderate_interactions INTEGER DEFAULT 0,\n    minor_interactions INTEGER DEFAULT 0,\n    ai_analysis TEXT,\n    risk_score INTEGER CHECK (risk_score BETWEEN 0 AND 100),\n    recommendations TEXT,\n    report_generated BOOLEAN DEFAULT false,\n    report_url TEXT,\n    checked_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Table: interaction_alerts\nCREATE TABLE IF NOT EXISTS interaction_alerts (\n    id SERIAL PRIMARY KEY,\n    check_id INTEGER NOT NULL REFERENCES interaction_checks(id) ON DELETE CASCADE,\n    interaction_id INTEGER REFERENCES drug_interactions(id),\n    drug_a_name VARCHAR(255) NOT NULL,\n    drug_b_name VARCHAR(255) NOT NULL,\n    severity VARCHAR(50) NOT NULL,\n    alert_message TEXT NOT NULL,\n    recommendation TEXT,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Table: alternative_medications\nCREATE TABLE IF NOT EXISTS alternative_medications (\n    id SERIAL PRIMARY KEY,\n    check_id INTEGER NOT NULL REFERENCES interaction_checks(id) ON DELETE CASCADE,\n    original_medication_rxcui VARCHAR(50) NOT NULL,\n    alternative_rxcui VARCHAR(50) NOT NULL,\n    alternative_name VARCHAR(255) NOT NULL,\n    reason TEXT NOT NULL,\n    safety_profile TEXT,\n    efficacy_comparison TEXT,\n    cost_comparison VARCHAR(50),\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Indexes\nCREATE INDEX IF NOT EXISTS idx_medications_rxcui ON medications(rxcui);\nCREATE INDEX IF NOT EXISTS idx_medications_drug_name ON medications(drug_name);\nCREATE INDEX IF NOT EXISTS idx_medications_generic_name ON medications(generic_name);\nCREATE INDEX IF NOT EXISTS idx_drug_interactions_drugs ON drug_interactions(drug_a_rxcui, drug_b_rxcui);\nCREATE INDEX IF NOT EXISTS idx_user_medication_lists_user ON user_medication_lists(user_id);\nCREATE INDEX IF NOT EXISTS idx_user_medications_list ON user_medications(list_id);\nCREATE INDEX IF NOT EXISTS idx_interaction_checks_user ON interaction_checks(user_id);\nCREATE INDEX IF NOT EXISTS idx_interaction_alerts_check ON interaction_alerts(check_id);",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 2bdzn41uM6mMWcv.97707ddd6929 --database 3gcYftfyZmb2335Uoynmho --execute -- RxGuard™ Database Schema\n-- Drug Interaction Checker Platform\n\n-- Table: medications\nCREATE TABLE IF NOT EXISTS medications (\n    id SERIAL PRIMARY KEY,\n    rxcui VARCHAR(50) UNIQUE NOT NULL,\n    drug_name VARCHAR(255) NOT NULL,\n    generic_name VARCHAR(255),\n    brand_names TEXT[],\n    active_ingredients TEXT[],\n    dosage_form VARCHAR(100),\n    strength VARCHAR(100),\n    manufacturer VARCHAR(255),\n    ndc_codes TEXT[],\n    drug_class VARCHAR(255),\n    fda_application_number VARCHAR(50),\n    approval_date DATE,\n    warnings TEXT,\n    contraindications TEXT,\n    adverse_reactions TEXT,\n    drug_interactions TEXT,\n    pregnancy_category VARCHAR(10),\n    controlled_substance_class VARCHAR(10),\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Table: drug_interactions\nCREATE TABLE IF NOT EXISTS drug_interactions (\n    id SERIAL PRIMARY KEY,\n    drug_a_rxcui VARCHAR(50) NOT NULL,\n    drug_b_rxcui VARCHAR(50) NOT NULL,\n    interaction_type VARCHAR(50) NOT NULL,\n    severity_score INTEGER CHECK (severity_score BETWEEN 1 AND 10),\n    description TEXT NOT NULL,\n    mechanism TEXT,\n    clinical_effects TEXT,\n    management_recommendations TEXT,\n    evidence_level VARCHAR(50),\n    source VARCHAR(100),\n    source_url TEXT,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    CONSTRAINT unique_interaction UNIQUE (drug_a_rxcui, drug_b_rxcui)\n);\n\n-- Table: user_medication_lists\nCREATE TABLE IF NOT EXISTS user_medication_lists (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER NOT NULL,\n    list_name VARCHAR(255) DEFAULT 'My Medications',\n    is_active BOOLEAN DEFAULT true,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Table: user_medications\nCREATE TABLE IF NOT EXISTS user_medications (\n    id SERIAL PRIMARY KEY,\n    list_id INTEGER NOT NULL REFERENCES user_medication_lists(id) ON DELETE CASCADE,\n    medication_id INTEGER NOT NULL REFERENCES medications(id),\n    dosage VARCHAR(100),\n    frequency VARCHAR(100),\n    route VARCHAR(50),\n    start_date DATE,\n    end_date DATE,\n    prescriber_name VARCHAR(255),\n    notes TEXT,\n    is_active BOOLEAN DEFAULT true,\n    added_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Table: interaction_checks\nCREATE TABLE IF NOT EXISTS interaction_checks (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER NOT NULL,\n    list_id INTEGER REFERENCES user_medication_lists(id),\n    medications_checked TEXT[],\n    interactions_found INTEGER DEFAULT 0,\n    major_interactions INTEGER DEFAULT 0,\n    moderate_interactions INTEGER DEFAULT 0,\n    minor_interactions INTEGER DEFAULT 0,\n    ai_analysis TEXT,\n    risk_score INTEGER CHECK (risk_score BETWEEN 0 AND 100),\n    recommendations TEXT,\n    report_generated BOOLEAN DEFAULT false,\n    report_url TEXT,\n    checked_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Table: interaction_alerts\nCREATE TABLE IF NOT EXISTS interaction_alerts (\n    id SERIAL PRIMARY KEY,\n    check_id INTEGER NOT NULL REFERENCES interaction_checks(id) ON DELETE CASCADE,\n    interaction_id INTEGER REFERENCES drug_interactions(id),\n    drug_a_name VARCHAR(255) NOT NULL,\n    drug_b_name VARCHAR(255) NOT NULL,\n    severity VARCHAR(50) NOT NULL,\n    alert_message TEXT NOT NULL,\n    recommendation TEXT,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Table: alternative_medications\nCREATE TABLE IF NOT EXISTS alternative_medications (\n    id SERIAL PRIMARY KEY,\n    check_id INTEGER NOT NULL REFERENCES interaction_checks(id) ON DELETE CASCADE,\n    original_medication_rxcui VARCHAR(50) NOT NULL,\n    alternative_rxcui VARCHAR(50) NOT NULL,\n    alternative_name VARCHAR(255) NOT NULL,\n    reason TEXT NOT NULL,\n    safety_profile TEXT,\n    efficacy_comparison TEXT,\n    cost_comparison VARCHAR(50),\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Indexes\nCREATE INDEX IF NOT EXISTS idx_medications_rxcui ON medications(rxcui);\nCREATE INDEX IF NOT EXISTS idx_medications_drug_name ON medications(drug_name);\nCREATE INDEX IF NOT EXISTS idx_medications_generic_name ON medications(generic_name);\nCREATE INDEX IF NOT EXISTS idx_drug_interactions_drugs ON drug_interactions(drug_a_rxcui, drug_b_rxcui);\nCREATE INDEX IF NOT EXISTS idx_user_medication_lists_user ON user_medication_lists(user_id);\nCREATE INDEX IF NOT EXISTS idx_user_medications_list ON user_medications(list_id);\nCREATE INDEX IF NOT EXISTS idx_interaction_checks_user ON interaction_checks(user_id);\nCREATE INDEX IF NOT EXISTS idx_interaction_alerts_check ON interaction_alerts(check_id);",
  "returncode": 1,
  "logs": [
    "ERROR 1064 (42000) at line 5: You have an error in your SQL syntax; check the manual that corresponds to your TiDB version for the right syntax to use line 6 column 22 near \"[],",
    "    active_ingredients TEXT[],",
    "    dosage_form VARCHAR(100),",
    "    strength VARCHAR(100),",
    "    manufacturer VARCHAR(255),",
    "    ndc_codes TEXT[],",
    "    drug_class VARCHAR(255),",
    "    fda_application_number VARCHAR(50),",
    "    approval_date DATE,",
    "    warnings TEXT,",
    "    contraindications TEXT,",
    "    adverse_reactions TEXT,",
    "    drug_interactions TEXT,",
    "    pregnancy_category VAR"
  ]
}